<div class="container-xs new-post-form">
  <h2>New post</h2>

  <form action="/api/posts/create" method="post">
    <div>
      <label for="title">Title</label>
      <input type="text" name="title" placeholder="Title" required minlength="10" maxlength="64" />
    </div>
    <div>
      <label for="content">Content</label>
      <textarea
        id="new-post-content"
        name="content"
        placeholder="Content"
        minlength="10"
        maxlength="400"
        required
      ></textarea>
      <div id="new-post-remaining-count">400</div>
    </div>
    <div class="form-actions is-compact">
      <button class="button" type="submit">Create post</button>
    </div>
  </form>
</div>

<script>
  const textarea = document.getElementById('new-post-content')
  const charCount = document.getElementById('new-post-remaining-count')
  const maxLength = parseInt(textarea.getAttribute('maxlength'), 10)

  textarea.addEventListener('input', () => {
    const remaining = maxLength - textarea.value.length
    charCount.textContent = remaining

    // Reset classes
    charCount.classList.remove('warning', 'danger')

    // Apply color based on remaining characters
    if (remaining < 5) {
      charCount.classList.add('danger')
    } else if (remaining < 20) {
      charCount.classList.add('warning')
    }
  })
</script>
