---
import '../styles/global.css'
import Layout from '@components/Layout.astro'
import LoginForm from '@components/LoginForm'
import { setFeedback } from '@utils/feedback'
import { beforePageLoad } from '@utils/page-hooks'

const { feedback, user } = await beforePageLoad({ cookies: Astro.cookies })

if (user) {
  setFeedback({ cookies: Astro.cookies, value: 'already_logged_in' })
  return Astro.redirect('/')
}
---

<Layout title="Login" feedback={feedback} user={user}>
  <LoginForm client:load />
</Layout>
